import { Image, Center } from "@mantine/core";
import Link from "next/link";

## El protocolo MQTT

<Center>
  <Image
    mb={"sm"}
    radius="md"
    h={300}
    src="https://hlassets.paessler.com/common/files/infographics/mqtt-architecture.png"
  />
</Center>

El protocolo MQTT (Message Queuing Telemetry Transport) es un estándar abierto y ligero de mensajería ideal para el Internet de las Cosas (IoT). Su popularidad en este ámbito se debe a varias características clave:

Ligereza y eficiencia: MQTT requiere pocos recursos para su implementación, lo que lo hace adecuado para dispositivos IoT con limitaciones de potencia, consumo y ancho de banda, como microcontroladores pequeños.

Escalabilidad: Puede gestionar un gran número de dispositivos conectados sin problemas, adaptándose a las necesidades de redes IoT masivas.

Fiabilidad: Ofrece diferentes niveles de calidad de servicio (QoS) para garantizar la entrega confiable de los mensajes, incluso en condiciones de red inestables.

Seguridad: Admite la comunicación segura a través del protocolo SSL/TLS, permitiendo la autenticación y autorización de dispositivos para proteger los datos transmitidos.

Funcionamiento:

MQTT utiliza un modelo de publicación/suscripción (pub-sub) para la comunicación. En este modelo, los dispositivos IoT se conectan a un servidor central llamado broker. Los dispositivos que envían datos actúan como publicadores, mientras que los que reciben datos actúan como suscriptores.

- Publicadores: Publican mensajes en tópicos específicos, que son como canales temáticos.
- Suscriptores: Se suscriben a tópicos de su interés.
- Broker: Recibe los mensajes publicados y los envía a los suscriptores correspondientes a cada tópico.

Este modelo desacopla a los publicadores y suscriptores, permitiendo una comunicación eficiente y escalable, ya que los dispositivos no necesitan conocer la ubicación exacta de los demás, solo el tópico a utilizar.

MQTT es un protocolo fundamental en IoT por su eficiencia, escalabilidad, fiabilidad y seguridad, facilitando la comunicación entre dispositivos y plataformas en este ecosistema.

## Los Tópicos en el Protocolo MQTT

Los tópicos son un componente fundamental del protocolo MQTT. Son como canales temáticos que permiten a los dispositivos IoT comunicarse de manera eficiente y escalable.

Características:

-   Cadenas de texto UTF-8: Los tópicos son cadenas de texto que pueden contener letras, números, símbolos y caracteres especiales.
-   Longitud máxima: La longitud máxima de un tópico es de 65536 caracteres, aunque en la práctica se suelen usar nombres más cortos y descriptivos.
-   Sensibilidad a mayúsculas y minúsculas: Los tópicos distinguen entre mayúsculas y minúsculas, por lo que "casa/sala" y "casa/Sala" son dos tópicos diferentes.
-   Estructura jerárquica: Los tópicos pueden tener una estructura jerárquica, similar a la de un árbol, utilizando la barra inclinada "/" como separador.

Ejemplo:

-   `casa/sala/temperatura`
-   `casa/cocina/luz`
-   `casa/dormitorio/humedad`

En este ejemplo, "casa" es el nivel superior del tópico, y "sala", "cocina" y "dormitorio" son subtópicos.

Funcionamiento:

Los dispositivos IoT publican mensajes en tópicos específicos. Los dispositivos que suscriben a un tópico recibirán todos los mensajes publicados en él.

Ventajas:

-   Flexibilidad: Los tópicos permiten una comunicación flexible y adaptable a diferentes necesidades.
-   Escalabilidad: Los tópicos permiten una comunicación eficiente y escalable, incluso con un gran número de dispositivos.
-   Descubrimiento de dispositivos: Los dispositivos pueden descubrir otros dispositivos que publican o suscriben a un tópico específico.

Recomendaciones:

-   Nombres descriptivos: Es recomendable utilizar nombres descriptivos para los tópicos, para facilitar la comprensión de la información que se transmite.
-   Estructura jerárquica: La estructura jerárquica puede ayudar a organizar los tópicos de forma lógica y eficiente.
-   Uso de comodines: Los caracteres comodín "#" y "+" pueden utilizarse para suscribirse a múltiples tópicos de forma simultánea.

## Comodines en MQTT

Los comodines son caracteres especiales que se pueden utilizar en las suscripciones de MQTT para suscribirse a múltiples tópicos de forma simultánea. Hay dos tipos de comodines:

1\. Comodín de un solo nivel (+):

-   Reemplaza exactamente un nivel del tópico.
-   Puede utilizarse varias veces en la suscripción.

Ejemplo:

-   `casa/+` se suscribirá a todos los tópicos que empiecen por "casa", como "casa/sala", "casa/cocina", "casa/jardin", etc.
-   `+/luz` se suscribirá a todos los tópicos que terminen en "luz", como "casa/sala/luz", "cocina/luz", "dormitorio/luz", etc.
-   `casa/+/temperatura` se suscribirá a todos los tópicos que tengan "casa" como primer nivel y "temperatura" como tercer nivel, como "casa/sala/temperatura", "casa/cocina/temperatura", etc.

2\. Comodín multinivel (#):

-   Reemplaza cualquier número de niveles del tópico.
-   Solo se puede utilizar una vez al final de la suscripción.

Ejemplo:

-   `casa/#` se suscribirá a todos los tópicos que empiecen por "casa", incluyendo subtópicos a cualquier nivel, como "casa/sala", "casa/cocina/luz", "casa/jardin/temperatura", etc.

Recomendaciones:

-   Utilizar con cuidado: Los comodines pueden ser muy potentes, y es importante utilizarlos con cuidado para evitar suscribirse a más tópicos de los necesarios.
-   Seguridad: Asegurarse de que los permisos de acceso a los tópicos sean adecuados para evitar la recepción de mensajes no deseados.
-   Pruebas: Es recomendable realizar pruebas para verificar que las suscripciones con comodines funcionan como se espera.


## Free Public MQTT Broker 

### Broker.emqx.io

Broker.emqx.io es un broker MQTT público y gratuito proporcionado por EMQ, una empresa especializada en tecnología MQTT.

Características:

-   Acceso libre: Puedes conectarte y utilizarlo sin costo alguno.
-   Alta escalabilidad: Soporta un gran número de conexiones simultáneas de dispositivos IoT.
-   Alto rendimiento: Ofrece un procesamiento rápido de mensajes y baja latencia.
-   Seguridad: Implementa protocolos de seguridad como TLS/SSL para la autenticación y el cifrado de datos.
-   Facilidad de uso: Es fácil de configurar y usar, ideal para principiantes y proyectos de prueba.

Uso:

-   Conectar dispositivos IoT: Puedes conectar tus dispositivos IoT al broker para que publiquen y reciban datos.
-   Enviar y recibir mensajes: Puedes enviar y recibir mensajes entre dispositivos, aplicaciones y plataformas.
-   Prototipado rápido: Puedes usar el broker para prototipar rápidamente aplicaciones IoT sin necesidad de configurar tu propio broker.

Limitaciones:

-   Funcionalidad básica: El broker ofrece las funciones básicas de MQTT, pero no cuenta con características avanzadas como reglas, colas o persistencia de mensajes.
-   Uso no comercial: El broker es gratuito para uso no comercial. Para uso comercial, se requiere una suscripción de pago.

Alternativas:

-   CloudMQTT: Un broker MQTT de pago con características más avanzadas y opciones de escalabilidad.
-   HiveMQ: Un broker MQTT de pago con enfoque en la seguridad y la alta disponibilidad.
-   Mosquitto: Un broker MQTT de código abierto que puedes instalar y configurar en tu propio servidor.

<Link href="https://www.emqx.com/en/mqtt/public-mqtt5-broker" target="_blank">
  MQTT Broker
</Link>


